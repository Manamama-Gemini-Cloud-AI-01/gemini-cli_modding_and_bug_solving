Grok AI:

The raw, observable fact is that the installation failure of `@google/gemini-cli@0.3.2` on Termux stems from a dependency chain where `@lvce-editor/ripgrep@1.6.0`—a wrapper around the Rust-based `ripgrep` search tool—has a postinstall script (`src/postinstall.js` calling `downloadRipGrep.js:60`) that explicitly rejects the `android` platform with `VError: Unknown platform: android`. This script assumes only common platforms (e.g., Windows, macOS, Linux variants) and downloads prebuilt `ripgrep` binaries (v13.0.0-10), without any fallback to compilation from source. The `node-pty@1.0.0` dependency compiles fine via node-gyp, so the error is isolated to this `ripgrep` handling.

Blame falls unevenly but primarily on the maintainers of `@lvce-editor/ripgrep`, who are associated with the lvce-editor project (a VS Code fork or variant). They forked or adapted this from Microsoft's `@vscode/ripgrep` (used in VS Code), which also lacks Android support, but failed to extend platform checks or provide a source compilation path, making it brittle for non-standard environments like Termux. Ripgrep itself (the underlying tool by Andrew Gallant/BurntSushi) is blameless here—it's compileable on Android as you proved with `cargo build --release --target aarch64-linux-android`—but the npm wrapper doesn't leverage that.

Secondary blame goes to the `@google/gemini-cli` maintainers at Google, who own the repo (https://github.com/google-gemini/gemini-cli) and publish the package. They depend on `@lvce-editor/ripgrep` without testing or mitigating for mobile/Termux setups, despite known issues reported in their GitHub (e.g., #7736: "Termux install fails," #3879: "Install on Termux without root"). Google promotes Gemini CLI as a terminal tool for developers, including on Linux, but ignores Android's Linux-based subset, leading to avoidable failures like yours. This reflects institutional negligence—prioritizing common desktops over edge cases, even as Termux users report similar native dep errors (e.g., with greenlet in other threads).

Tertiary blame lies with the npm maintainers (now under Microsoft/GitHub), whose ecosystem design lacks pip's automatic fallback to source compilation for native deps. Npm delegates native builds to package-specific postinstall scripts (often using node-gyp or prebuild tools), with no universal switch like pip's `--no-binary` to force source builds. This stems from Node.js treating native addons as afterthoughts (JavaScript-first philosophy), unlike Python's standardized C extensions and wheel/sdist system. Community complaints highlight npm's reliance on potentially flawed scripts without isolation or enforcement, making failures like yours common on uncommon platforms. Npm's `--ignore-scripts` workaround skips the problem but doesn't solve it, exposing the deficiency.

In moral terms, this is a cascade of laziness: wrapper maintainers ignore portability; Google ships untested deps; npm enables the mess by not mandating better standards. No one entity is solely at fault, but the error's persistence shows ecosystem-wide hypocrisy—claiming cross-platform while failing basic edge cases.



Full discussion: https://grok.com/share/bGVnYWN5_0780db52-6572-4034-a307-d919daf22ef4